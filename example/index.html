<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Ticketbase API test</title>
  <script src="../ticketbase.js"></script>
  <style>
    * { box-sizing: border-box; }
    body { max-width: 300px; margin: 50px auto; font-size: 10pt; }
    input, textarea, button { width: 100%; display: block; margin: 20px 0; }
    input { padding: 10px; }
    button { height: 50px; line-height: 50px; }
    textarea { height: 300px; padding: 10px; font-size: 1em; font-family: sans-serif; }
  </style>
</head>
<body>
  <input type='text' id='key' placeholder='Paste API key here...'>
  <button id='btn'>Get current events</button>
  <textarea id='output'></textarea>
  <script>
    function log (msg) {
      document.getElementById('output').value += msg + '\n';
    }

    function clear () {
      document.getElementById('output').value = '';
    }

    document.getElementById('btn').addEventListener('click', function () {
      clear();

      var key = document.getElementById('key').value;
      if (!key) {
        alert("Use an API key.");
        return;
      }

      TB.setKey(key);
      log("Contacting API...\n");

      TB.request('GET', '/events.json')
        .then(function (events) {
          log("Response:\n");
          log(JSON.stringify(events, null, 2));
        },
        function (err) {
          log("!! Error received.\n");
          log("" + err.message);
          if (err.body)
            log(JSON.stringify(err.body, null, 2));
        });
    });

    clear();
  </script>
  
</body>
</html>
